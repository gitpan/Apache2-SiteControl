PerlModule Apache2::SiteControl::AccessController
PerlModule HTML::Mason::ApacheHandler

PerlSetVar MasonArgsMethod CGI

<Location /sample>
   SetHandler perl-script
   PerlResponseHandler HTML::Mason::ApacheHandler # ModPerl::Registry
   PerlOptions +GlobalRequest 
   # +ParseHeaders
   # Options +ExecCGI

   AuthType Apache2::SiteControl::AccessController
   AuthName sample

   # Set up the method of credential verification. See
   # Apache2::SiteControl::AccessController for help on making your own.
   PerlSetVar Apache2::SiteControlMethod Apache2::SiteControl::Radius

   # Turn on debugging
   PerlSetVar AccessControllerDebug 1

   # Configure the factories. See Apache2::SiteControl::UserFactory and
   # Apache2::SiteControl::ManagerFactory
   PerlSetVar AccessControllerManagerFactory samples::site::MyPermissionFactory

   # Configure the location of the session data on server disks
   PerlSetVar AccessControllerSessions /tmp/sessions
   PerlSetVar AccessControllerLocks /tmp/sessions/locks

   # Tell mod_perl that you want this module to control access:
   PerlAuthenHandler Apache2::SiteControl::AccessController->authenticate
   PerlAuthzHandler Apache2::SiteControl::AccessController->authorize

   # Choose a name for the instance of the authenticator. This name is
   # used as part of the remaining variable names.
   PerlSetVar AuthName sample

   # Set the path that will be protected
   PerlSetVar samplePath /sample

   # Indicate the path to the login page. Be careful, HTML::Mason can 
   # interfere with proper handling...make sure you know your dependencies.
   # See samples and Apache2::AuthCookie for more information.
   PerlSetVar sampleLoginScript /samplelogin.pl

   # See Apache2::AuthCookie for descriptions of these.
   PerlSetVar sampleSatisfy All
   PerlSetVar sampleDomain .uoregon.edu
   PerlSetVar sampleCache 1
   PerlSetVar sampleExpires +2h

   require valid-user
</Location>

<FilesMatch "samplelogin\.pl$">
 AuthType Apache2::SiteControl::AccessController
 AuthName sample
 SetHandler perl-script

 # NOTE NOTE NOTE ************************************************
 # This next line is different for Apache 1.x and Apache 2.x 
 # This is the 2.x version:
 PerlHandler ModPerl::Registry

 PerlSetVar AccessControllerDebug 9
 PerlSetVar RadiusAccessControlHost "localhost"
 PerlSetVar RadiusAccessControllerSecret "boogerstasteyummy"
 Options +ExecCGI
</FilesMatch>

<Location /SampleLogin>
   AuthType Apache2::SiteControl::AccessController
   AuthName sample
   SetHandler perl-script
   PerlHandler Apache2::SiteControl::AccessController->login
   PerlSetVar AccessControllerDebug 9
   PerlSetVar sampleLoginScript /samplelogin.pl
   PerlSetVar RadiusAccessControlHost "localhost"
   PerlSetVar RadiusAccessControllerSecret "boogerstasteyummy"
   PerlSetVar AccessControllerSessions /tmp/sessions
   PerlSetVar AccessControllerLocks /tmp/sessions/locks
</Location>
